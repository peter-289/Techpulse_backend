from __future__ import annotations

from abc import ABC, abstractmethod
from typing import AsyncIterable


class MalwareScanner(ABC):
    @abstractmethod
    async def scan_stream(
        self,
        stream: AsyncIterable[bytes],
        *,
        filename: str,
        content_type: str | None,
    ) -> None:
        """Raise on malware detection."""


class NoOpMalwareScanner(MalwareScanner):
    async def scan_stream(
        self,
        stream: AsyncIterable[bytes],
        *,
        filename: str,
        content_type: str | None,
    ) -> None:
        return
